{"ast":null,"code":"import _objectSpread from \"/tmp/daft-chat-temp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/tmp/daft-chat-temp/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"children\", \"className\", \"listenToScroll\", \"loadNextDebounceMs\", \"loadNextOnScrollToBottom\", \"loadNextOnScrollToTop\", \"threshold\", \"useCapture\"];\nimport clsx from 'clsx';\nimport debounce from 'lodash.debounce';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { DEFAULT_LOAD_PAGE_SCROLL_THRESHOLD } from '../../constants/limits';\n/**\n * Prevents Chrome hangups\n * See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n */\nconst mousewheelListener = event => {\n  if (event instanceof WheelEvent && event.deltaY === 1) {\n    event.preventDefault();\n  }\n};\nexport const InfiniteScrollPaginator = props => {\n  const {\n      children,\n      className,\n      listenToScroll,\n      loadNextDebounceMs = 500,\n      loadNextOnScrollToBottom,\n      loadNextOnScrollToTop,\n      threshold = DEFAULT_LOAD_PAGE_SCROLL_THRESHOLD,\n      useCapture = false\n    } = props,\n    componentProps = _objectWithoutProperties(props, _excluded);\n  const rootRef = useRef(null);\n  const childRef = useRef(null);\n  const scrollListener = useMemo(() => debounce(() => {\n    const root = rootRef.current;\n    const child = childRef.current;\n    if (!root || root.offsetParent === null || !child) {\n      return;\n    }\n    const distanceFromBottom = child.scrollHeight - root.scrollTop - root.clientHeight;\n    const distanceFromTop = root.scrollTop;\n    if (listenToScroll) {\n      listenToScroll(distanceFromBottom, distanceFromTop, threshold);\n    }\n    if (distanceFromTop < Number(threshold)) {\n      loadNextOnScrollToTop === null || loadNextOnScrollToTop === void 0 || loadNextOnScrollToTop();\n    }\n    if (distanceFromBottom < Number(threshold)) {\n      loadNextOnScrollToBottom === null || loadNextOnScrollToBottom === void 0 || loadNextOnScrollToBottom();\n    }\n  }, loadNextDebounceMs), [listenToScroll, loadNextDebounceMs, loadNextOnScrollToBottom, loadNextOnScrollToTop, threshold]);\n  useEffect(() => {\n    const scrollElement = rootRef.current;\n    if (!scrollElement) return;\n    scrollElement.addEventListener('scroll', scrollListener, useCapture);\n    return () => {\n      scrollElement.removeEventListener('scroll', scrollListener, useCapture);\n    };\n  }, [scrollListener, useCapture]);\n  useEffect(() => {\n    const root = rootRef.current;\n    if (!root || typeof ResizeObserver === 'undefined' || !scrollListener) return;\n    const observer = new ResizeObserver(scrollListener);\n    observer.observe(root);\n    return () => {\n      observer.disconnect();\n    };\n  }, [scrollListener]);\n  useEffect(() => {\n    const root = rootRef.current;\n    if (root) {\n      root.addEventListener('wheel', mousewheelListener, {\n        passive: false\n      });\n    }\n    return () => {\n      if (root) {\n        root.removeEventListener('wheel', mousewheelListener, useCapture);\n      }\n    };\n  }, [useCapture]);\n  return React.createElement(\"div\", _objectSpread(_objectSpread({}, componentProps), {}, {\n    className: clsx('str-chat__infinite-scroll-paginator', className),\n    ref: rootRef\n  }), React.createElement(\"div\", {\n    className: 'str-chat__infinite-scroll-paginator__content',\n    ref: childRef\n  }, children));\n};","map":{"version":3,"names":["clsx","debounce","React","useEffect","useMemo","useRef","DEFAULT_LOAD_PAGE_SCROLL_THRESHOLD","mousewheelListener","event","WheelEvent","deltaY","preventDefault","InfiniteScrollPaginator","props","children","className","listenToScroll","loadNextDebounceMs","loadNextOnScrollToBottom","loadNextOnScrollToTop","threshold","useCapture","componentProps","_objectWithoutProperties","_excluded","rootRef","childRef","scrollListener","root","current","child","offsetParent","distanceFromBottom","scrollHeight","scrollTop","clientHeight","distanceFromTop","Number","scrollElement","addEventListener","removeEventListener","ResizeObserver","observer","observe","disconnect","passive","createElement","_objectSpread","ref"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/InfiniteScrollPaginator/InfiniteScrollPaginator.js"],"sourcesContent":["import clsx from 'clsx';\nimport debounce from 'lodash.debounce';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { DEFAULT_LOAD_PAGE_SCROLL_THRESHOLD } from '../../constants/limits';\n/**\n * Prevents Chrome hangups\n * See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n */\nconst mousewheelListener = (event) => {\n    if (event instanceof WheelEvent && event.deltaY === 1) {\n        event.preventDefault();\n    }\n};\nexport const InfiniteScrollPaginator = (props) => {\n    const { children, className, listenToScroll, loadNextDebounceMs = 500, loadNextOnScrollToBottom, loadNextOnScrollToTop, threshold = DEFAULT_LOAD_PAGE_SCROLL_THRESHOLD, useCapture = false, ...componentProps } = props;\n    const rootRef = useRef(null);\n    const childRef = useRef(null);\n    const scrollListener = useMemo(() => debounce(() => {\n        const root = rootRef.current;\n        const child = childRef.current;\n        if (!root || root.offsetParent === null || !child) {\n            return;\n        }\n        const distanceFromBottom = child.scrollHeight - root.scrollTop - root.clientHeight;\n        const distanceFromTop = root.scrollTop;\n        if (listenToScroll) {\n            listenToScroll(distanceFromBottom, distanceFromTop, threshold);\n        }\n        if (distanceFromTop < Number(threshold)) {\n            loadNextOnScrollToTop?.();\n        }\n        if (distanceFromBottom < Number(threshold)) {\n            loadNextOnScrollToBottom?.();\n        }\n    }, loadNextDebounceMs), [\n        listenToScroll,\n        loadNextDebounceMs,\n        loadNextOnScrollToBottom,\n        loadNextOnScrollToTop,\n        threshold,\n    ]);\n    useEffect(() => {\n        const scrollElement = rootRef.current;\n        if (!scrollElement)\n            return;\n        scrollElement.addEventListener('scroll', scrollListener, useCapture);\n        return () => {\n            scrollElement.removeEventListener('scroll', scrollListener, useCapture);\n        };\n    }, [scrollListener, useCapture]);\n    useEffect(() => {\n        const root = rootRef.current;\n        if (!root || typeof ResizeObserver === 'undefined' || !scrollListener)\n            return;\n        const observer = new ResizeObserver(scrollListener);\n        observer.observe(root);\n        return () => {\n            observer.disconnect();\n        };\n    }, [scrollListener]);\n    useEffect(() => {\n        const root = rootRef.current;\n        if (root) {\n            root.addEventListener('wheel', mousewheelListener, { passive: false });\n        }\n        return () => {\n            if (root) {\n                root.removeEventListener('wheel', mousewheelListener, useCapture);\n            }\n        };\n    }, [useCapture]);\n    return (React.createElement(\"div\", { ...componentProps, className: clsx('str-chat__infinite-scroll-paginator', className), ref: rootRef },\n        React.createElement(\"div\", { className: 'str-chat__infinite-scroll-paginator__content', ref: childRef }, children)));\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}