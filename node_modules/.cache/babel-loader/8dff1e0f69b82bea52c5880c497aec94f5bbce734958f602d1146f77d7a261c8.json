{"ast":null,"code":"import React from 'react';\nimport clsx from 'clsx';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useTypingContext } from '../../context/TypingContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nconst useJoinTypingUsers = names => {\n  const {\n    t\n  } = useTranslationContext();\n  if (!names.length) return null;\n  const [name, ...rest] = names;\n  if (names.length === 1) return t('{{ user }} is typing...', {\n    user: name\n  });\n  const MAX_JOINED_USERS = 3;\n  if (names.length > MAX_JOINED_USERS) return t('{{ users }} and more are typing...', {\n    users: names.slice(0, MAX_JOINED_USERS).join(', ').trim()\n  });\n  return t('{{ users }} and {{ user }} are typing...', {\n    user: name,\n    users: rest.join(', ').trim()\n  });\n};\n/**\n * TypingIndicator lists users currently typing, it needs to be a child of Channel component\n */\nconst UnMemoizedTypingIndicator = props => {\n  const {\n    threadList\n  } = props;\n  const {\n    channelConfig,\n    thread\n  } = useChannelStateContext('TypingIndicator');\n  const {\n    client\n  } = useChatContext('TypingIndicator');\n  const {\n    typing = {}\n  } = useTypingContext('TypingIndicator');\n  const typingInChannel = !threadList ? Object.values(typing).filter(_ref => {\n    var _client$user;\n    let {\n      parent_id,\n      user\n    } = _ref;\n    return (user === null || user === void 0 ? void 0 : user.id) !== ((_client$user = client.user) === null || _client$user === void 0 ? void 0 : _client$user.id) && !parent_id;\n  }) : [];\n  const typingInThread = threadList ? Object.values(typing).filter(_ref2 => {\n    var _client$user2;\n    let {\n      parent_id,\n      user\n    } = _ref2;\n    return (user === null || user === void 0 ? void 0 : user.id) !== ((_client$user2 = client.user) === null || _client$user2 === void 0 ? void 0 : _client$user2.id) && parent_id === (thread === null || thread === void 0 ? void 0 : thread.id);\n  }) : [];\n  const typingUserList = (threadList ? typingInThread : typingInChannel).map(_ref3 => {\n    let {\n      user\n    } = _ref3;\n    return (user === null || user === void 0 ? void 0 : user.name) || (user === null || user === void 0 ? void 0 : user.id);\n  }).filter(Boolean);\n  const joinedTypingUsers = useJoinTypingUsers(typingUserList);\n  const isTypingActive = threadList && typingInThread.length || !threadList && typingInChannel.length;\n  if ((channelConfig === null || channelConfig === void 0 ? void 0 : channelConfig.typing_events) === false) {\n    return null;\n  }\n  if (!isTypingActive) return null;\n  return React.createElement(\"div\", {\n    className: clsx('str-chat__typing-indicator', {\n      'str-chat__typing-indicator--typing': isTypingActive\n    }),\n    \"data-testid\": 'typing-indicator'\n  }, React.createElement(\"div\", {\n    className: 'str-chat__typing-indicator__dots'\n  }, React.createElement(\"span\", {\n    className: 'str-chat__typing-indicator__dot'\n  }), React.createElement(\"span\", {\n    className: 'str-chat__typing-indicator__dot'\n  }), React.createElement(\"span\", {\n    className: 'str-chat__typing-indicator__dot'\n  })), React.createElement(\"div\", {\n    className: 'str-chat__typing-indicator__users',\n    \"data-testid\": 'typing-users'\n  }, joinedTypingUsers));\n};\nexport const TypingIndicator = React.memo(UnMemoizedTypingIndicator);","map":{"version":3,"names":["React","clsx","useChannelStateContext","useChatContext","useTypingContext","useTranslationContext","useJoinTypingUsers","names","t","length","name","rest","user","MAX_JOINED_USERS","users","slice","join","trim","UnMemoizedTypingIndicator","props","threadList","channelConfig","thread","client","typing","typingInChannel","Object","values","filter","_ref","_client$user","parent_id","id","typingInThread","_ref2","_client$user2","typingUserList","map","_ref3","Boolean","joinedTypingUsers","isTypingActive","typing_events","createElement","className","TypingIndicator","memo"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/TypingIndicator/TypingIndicator.js"],"sourcesContent":["import React from 'react';\nimport clsx from 'clsx';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useTypingContext } from '../../context/TypingContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nconst useJoinTypingUsers = (names) => {\n    const { t } = useTranslationContext();\n    if (!names.length)\n        return null;\n    const [name, ...rest] = names;\n    if (names.length === 1)\n        return t('{{ user }} is typing...', {\n            user: name,\n        });\n    const MAX_JOINED_USERS = 3;\n    if (names.length > MAX_JOINED_USERS)\n        return t('{{ users }} and more are typing...', {\n            users: names.slice(0, MAX_JOINED_USERS).join(', ').trim(),\n        });\n    return t('{{ users }} and {{ user }} are typing...', {\n        user: name,\n        users: rest.join(', ').trim(),\n    });\n};\n/**\n * TypingIndicator lists users currently typing, it needs to be a child of Channel component\n */\nconst UnMemoizedTypingIndicator = (props) => {\n    const { threadList } = props;\n    const { channelConfig, thread } = useChannelStateContext('TypingIndicator');\n    const { client } = useChatContext('TypingIndicator');\n    const { typing = {} } = useTypingContext('TypingIndicator');\n    const typingInChannel = !threadList\n        ? Object.values(typing).filter(({ parent_id, user }) => user?.id !== client.user?.id && !parent_id)\n        : [];\n    const typingInThread = threadList\n        ? Object.values(typing).filter(({ parent_id, user }) => user?.id !== client.user?.id && parent_id === thread?.id)\n        : [];\n    const typingUserList = (threadList ? typingInThread : typingInChannel)\n        .map(({ user }) => user?.name || user?.id)\n        .filter(Boolean);\n    const joinedTypingUsers = useJoinTypingUsers(typingUserList);\n    const isTypingActive = (threadList && typingInThread.length) || (!threadList && typingInChannel.length);\n    if (channelConfig?.typing_events === false) {\n        return null;\n    }\n    if (!isTypingActive)\n        return null;\n    return (React.createElement(\"div\", { className: clsx('str-chat__typing-indicator', {\n            'str-chat__typing-indicator--typing': isTypingActive,\n        }), \"data-testid\": 'typing-indicator' },\n        React.createElement(\"div\", { className: 'str-chat__typing-indicator__dots' },\n            React.createElement(\"span\", { className: 'str-chat__typing-indicator__dot' }),\n            React.createElement(\"span\", { className: 'str-chat__typing-indicator__dot' }),\n            React.createElement(\"span\", { className: 'str-chat__typing-indicator__dot' })),\n        React.createElement(\"div\", { className: 'str-chat__typing-indicator__users', \"data-testid\": 'typing-users' }, joinedTypingUsers)));\n};\nexport const TypingIndicator = React.memo(UnMemoizedTypingIndicator);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}