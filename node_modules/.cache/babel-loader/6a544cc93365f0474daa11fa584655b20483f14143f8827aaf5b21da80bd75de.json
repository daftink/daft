{"ast":null,"code":"import React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { MessageDeliveredIcon } from './icons';\nimport { getReadByTooltipText, mapToUserNameOrId } from './utils';\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { LoadingIndicator } from '../Loading';\nimport { PopperTooltip } from '../Tooltip';\nimport { useEnterLeaveHandlers } from '../Tooltip/hooks';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nconst UnMemoizedMessageStatus = props => {\n  var _client$user;\n  const {\n    Avatar: propAvatar,\n    MessageDeliveredStatus,\n    MessageReadStatus,\n    MessageSendingStatus,\n    messageType = 'simple',\n    tooltipUserNameMapper = mapToUserNameOrId\n  } = props;\n  const {\n    handleEnter,\n    handleLeave,\n    tooltipVisible\n  } = useEnterLeaveHandlers();\n  const {\n    client\n  } = useChatContext('MessageStatus');\n  const {\n    Avatar: contextAvatar\n  } = useComponentContext('MessageStatus');\n  const {\n    isMyMessage,\n    lastReceivedId,\n    message,\n    readBy,\n    threadList\n  } = useMessageContext('MessageStatus');\n  const {\n    t\n  } = useTranslationContext('MessageStatus');\n  const [referenceElement, setReferenceElement] = useState(null);\n  const Avatar = propAvatar || contextAvatar || DefaultAvatar;\n  if (!isMyMessage() || message.type === 'error') return null;\n  const justReadByMe = (readBy === null || readBy === void 0 ? void 0 : readBy.length) === 1 && readBy[0].id === ((_client$user = client.user) === null || _client$user === void 0 ? void 0 : _client$user.id);\n  const rootClassName = \"str-chat__message-\".concat(messageType, \"-status str-chat__message-status\");\n  const sending = message.status === 'sending';\n  const delivered = message.status === 'received' && message.id === lastReceivedId && !threadList;\n  const deliveredAndRead = !!(readBy !== null && readBy !== void 0 && readBy.length && !threadList && !justReadByMe);\n  const readersWithoutOwnUser = deliveredAndRead ? readBy.filter(item => {\n    var _client$user2;\n    return item.id !== ((_client$user2 = client.user) === null || _client$user2 === void 0 ? void 0 : _client$user2.id);\n  }) : [];\n  const [lastReadUser] = readersWithoutOwnUser;\n  return React.createElement(\"span\", {\n    className: rootClassName,\n    \"data-testid\": clsx({\n      'message-status-read-by': deliveredAndRead,\n      'message-status-received': delivered && !deliveredAndRead,\n      'message-status-sending': sending\n    }),\n    onMouseEnter: handleEnter,\n    onMouseLeave: handleLeave,\n    ref: setReferenceElement\n  }, sending && (MessageSendingStatus ? React.createElement(MessageSendingStatus, null) : React.createElement(React.Fragment, null, React.createElement(PopperTooltip, {\n    offset: [0, 5],\n    referenceElement: referenceElement,\n    visible: tooltipVisible\n  }, t('Sending...')), React.createElement(LoadingIndicator, null))), delivered && !deliveredAndRead && (MessageDeliveredStatus ? React.createElement(MessageDeliveredStatus, null) : React.createElement(React.Fragment, null, React.createElement(PopperTooltip, {\n    offset: [0, 5],\n    referenceElement: referenceElement,\n    visible: tooltipVisible\n  }, t('Delivered')), React.createElement(MessageDeliveredIcon, null))), deliveredAndRead && (MessageReadStatus ? React.createElement(MessageReadStatus, null) : React.createElement(React.Fragment, null, React.createElement(PopperTooltip, {\n    offset: [0, 5],\n    referenceElement: referenceElement,\n    visible: tooltipVisible\n  }, getReadByTooltipText(readBy, t, client, tooltipUserNameMapper)), React.createElement(Avatar, {\n    className: 'str-chat__avatar--message-status',\n    image: lastReadUser.image,\n    name: lastReadUser.name || lastReadUser.id,\n    user: lastReadUser\n  }), readersWithoutOwnUser.length > 1 && React.createElement(\"span\", {\n    className: \"str-chat__message-\".concat(messageType, \"-status-number\"),\n    \"data-testid\": 'message-status-read-by-many'\n  }, readersWithoutOwnUser.length))));\n};\nexport const MessageStatus = React.memo(UnMemoizedMessageStatus);","map":{"version":3,"names":["React","useState","clsx","MessageDeliveredIcon","getReadByTooltipText","mapToUserNameOrId","Avatar","DefaultAvatar","LoadingIndicator","PopperTooltip","useEnterLeaveHandlers","useChatContext","useComponentContext","useMessageContext","useTranslationContext","UnMemoizedMessageStatus","props","_client$user","propAvatar","MessageDeliveredStatus","MessageReadStatus","MessageSendingStatus","messageType","tooltipUserNameMapper","handleEnter","handleLeave","tooltipVisible","client","contextAvatar","isMyMessage","lastReceivedId","message","readBy","threadList","t","referenceElement","setReferenceElement","type","justReadByMe","length","id","user","rootClassName","concat","sending","status","delivered","deliveredAndRead","readersWithoutOwnUser","filter","item","_client$user2","lastReadUser","createElement","className","onMouseEnter","onMouseLeave","ref","Fragment","offset","visible","image","name","MessageStatus","memo"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/Message/MessageStatus.js"],"sourcesContent":["import React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { MessageDeliveredIcon } from './icons';\nimport { getReadByTooltipText, mapToUserNameOrId } from './utils';\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { LoadingIndicator } from '../Loading';\nimport { PopperTooltip } from '../Tooltip';\nimport { useEnterLeaveHandlers } from '../Tooltip/hooks';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nconst UnMemoizedMessageStatus = (props) => {\n    const { Avatar: propAvatar, MessageDeliveredStatus, MessageReadStatus, MessageSendingStatus, messageType = 'simple', tooltipUserNameMapper = mapToUserNameOrId, } = props;\n    const { handleEnter, handleLeave, tooltipVisible } = useEnterLeaveHandlers();\n    const { client } = useChatContext('MessageStatus');\n    const { Avatar: contextAvatar } = useComponentContext('MessageStatus');\n    const { isMyMessage, lastReceivedId, message, readBy, threadList } = useMessageContext('MessageStatus');\n    const { t } = useTranslationContext('MessageStatus');\n    const [referenceElement, setReferenceElement] = useState(null);\n    const Avatar = propAvatar || contextAvatar || DefaultAvatar;\n    if (!isMyMessage() || message.type === 'error')\n        return null;\n    const justReadByMe = readBy?.length === 1 && readBy[0].id === client.user?.id;\n    const rootClassName = `str-chat__message-${messageType}-status str-chat__message-status`;\n    const sending = message.status === 'sending';\n    const delivered = message.status === 'received' && message.id === lastReceivedId && !threadList;\n    const deliveredAndRead = !!(readBy?.length && !threadList && !justReadByMe);\n    const readersWithoutOwnUser = deliveredAndRead\n        ? readBy.filter((item) => item.id !== client.user?.id)\n        : [];\n    const [lastReadUser] = readersWithoutOwnUser;\n    return (React.createElement(\"span\", { className: rootClassName, \"data-testid\": clsx({\n            'message-status-read-by': deliveredAndRead,\n            'message-status-received': delivered && !deliveredAndRead,\n            'message-status-sending': sending,\n        }), onMouseEnter: handleEnter, onMouseLeave: handleLeave, ref: setReferenceElement },\n        sending &&\n            (MessageSendingStatus ? (React.createElement(MessageSendingStatus, null)) : (React.createElement(React.Fragment, null,\n                React.createElement(PopperTooltip, { offset: [0, 5], referenceElement: referenceElement, visible: tooltipVisible }, t('Sending...')),\n                React.createElement(LoadingIndicator, null)))),\n        delivered &&\n            !deliveredAndRead &&\n            (MessageDeliveredStatus ? (React.createElement(MessageDeliveredStatus, null)) : (React.createElement(React.Fragment, null,\n                React.createElement(PopperTooltip, { offset: [0, 5], referenceElement: referenceElement, visible: tooltipVisible }, t('Delivered')),\n                React.createElement(MessageDeliveredIcon, null)))),\n        deliveredAndRead &&\n            (MessageReadStatus ? (React.createElement(MessageReadStatus, null)) : (React.createElement(React.Fragment, null,\n                React.createElement(PopperTooltip, { offset: [0, 5], referenceElement: referenceElement, visible: tooltipVisible }, getReadByTooltipText(readBy, t, client, tooltipUserNameMapper)),\n                React.createElement(Avatar, { className: 'str-chat__avatar--message-status', image: lastReadUser.image, name: lastReadUser.name || lastReadUser.id, user: lastReadUser }),\n                readersWithoutOwnUser.length > 1 && (React.createElement(\"span\", { className: `str-chat__message-${messageType}-status-number`, \"data-testid\": 'message-status-read-by-many' }, readersWithoutOwnUser.length)))))));\n};\nexport const MessageStatus = React.memo(UnMemoizedMessageStatus);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}