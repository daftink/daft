{"ast":null,"code":"import React, { useCallback, useMemo } from 'react';\nimport { useDeleteHandler, useUserRole } from './hooks';\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageTimestamp } from './MessageTimestamp';\nimport { getMessageActions } from './utils';\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport { MessageActions } from '../MessageActions';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText } from './renderText';\nconst selectColor = (number, dark) => {\n  const hue = number * 137.508; // use golden angle approximation\n  return \"hsl(\".concat(hue, \",\").concat(dark ? '50%' : '85%', \", \").concat(dark ? '75%' : '55%', \")\");\n};\nconst hashUserId = userId => {\n  const hash = userId.split('').reduce((acc, c) => {\n    acc = (acc << 5) - acc + c.charCodeAt(0);\n    return acc & acc;\n  }, 0);\n  return Math.abs(hash) / 10 ** Math.ceil(Math.log10(Math.abs(hash) + 1));\n};\nconst getUserColor = (theme, userId) => selectColor(hashUserId(userId), theme.includes('dark'));\nconst UnMemoizedFixedHeightMessage = props => {\n  var _message$i18n, _message$user, _message$attachments, _message$user2;\n  const {\n    groupedByUser: propGroupedByUser,\n    message: propMessage\n  } = props;\n  const {\n    theme\n  } = useChatContext('FixedHeightMessage');\n  const {\n    groupedByUser: contextGroupedByUser,\n    message: contextMessage\n  } = useMessageContext('FixedHeightMessage');\n  const {\n    MessageDeleted = DefaultMessageDeleted\n  } = useComponentContext('FixedHeightMessage');\n  const {\n    userLanguage\n  } = useTranslationContext('FixedHeightMessage');\n  const groupedByUser = propGroupedByUser !== undefined ? propGroupedByUser : contextGroupedByUser;\n  const message = propMessage || contextMessage;\n  const handleDelete = useDeleteHandler(message);\n  const role = useUserRole(message);\n  const messageTextToRender = (message === null || message === void 0 || (_message$i18n = message.i18n) === null || _message$i18n === void 0 ? void 0 : _message$i18n[\"\".concat(userLanguage, \"_text\")]) || (message === null || message === void 0 ? void 0 : message.text);\n  const renderedText = useMemo(() => renderText(messageTextToRender, message.mentioned_users), [message.mentioned_users, messageTextToRender]);\n  const userId = ((_message$user = message.user) === null || _message$user === void 0 ? void 0 : _message$user.id) || '';\n  const userColor = useMemo(() => getUserColor(theme, userId), [userId, theme]);\n  const messageActionsHandler = useCallback(() => getMessageActions(['delete'], {\n    canDelete: role.canDelete\n  }), [role]);\n  const images = message === null || message === void 0 || (_message$attachments = message.attachments) === null || _message$attachments === void 0 ? void 0 : _message$attachments.filter(_ref => {\n    let {\n      type\n    } = _ref;\n    return type === 'image';\n  });\n  return React.createElement(\"div\", {\n    className: \"str-chat__virtual-message__wrapper \".concat(role.isMyMessage ? 'str-chat__virtual-message__wrapper--me' : '', \" \").concat(groupedByUser ? 'str-chat__virtual-message__wrapper--group' : ''),\n    key: message.id\n  }, message.user && React.createElement(Avatar, {\n    image: message.user.image,\n    name: message.user.name || message.user.id,\n    user: message.user\n  }), React.createElement(\"div\", {\n    className: 'str-chat__virtual-message__content'\n  }, React.createElement(\"div\", {\n    className: 'str-chat__virtual-message__meta'\n  }, React.createElement(\"div\", {\n    className: 'str-chat__virtual-message__author',\n    style: {\n      color: userColor\n    }\n  }, React.createElement(\"strong\", null, ((_message$user2 = message.user) === null || _message$user2 === void 0 ? void 0 : _message$user2.name) || 'unknown'))), message.deleted_at || message.type === 'deleted' ? React.createElement(MessageDeleted, {\n    message: message\n  }) : React.createElement(React.Fragment, null, images && React.createElement(Gallery, {\n    images: images\n  }), React.createElement(\"div\", {\n    className: 'str-chat__virtual-message__text',\n    \"data-testid\": 'msg-text'\n  }, renderedText, React.createElement(\"div\", {\n    className: 'str-chat__virtual-message__data'\n  }, React.createElement(MessageActions, {\n    customWrapperClass: 'str-chat__virtual-message__actions',\n    getMessageActions: messageActionsHandler,\n    handleDelete: handleDelete,\n    message: message,\n    mine: () => role.isMyMessage\n  }), React.createElement(\"span\", {\n    className: 'str-chat__virtual-message__date'\n  }, React.createElement(MessageTimestamp, {\n    customClass: 'str-chat__message-simple-timestamp',\n    message: message\n  })))))));\n};\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * FixedHeightMessage - This component renders a single message.\n * It uses fixed height elements to make sure it works well in VirtualizedMessageList\n */\nexport const FixedHeightMessage = React.memo(UnMemoizedFixedHeightMessage);","map":{"version":3,"names":["React","useCallback","useMemo","useDeleteHandler","useUserRole","MessageDeleted","DefaultMessageDeleted","MessageTimestamp","getMessageActions","Avatar","Gallery","MessageActions","useChatContext","useComponentContext","useMessageContext","useTranslationContext","renderText","selectColor","number","dark","hue","concat","hashUserId","userId","hash","split","reduce","acc","c","charCodeAt","Math","abs","ceil","log10","getUserColor","theme","includes","UnMemoizedFixedHeightMessage","props","_message$i18n","_message$user","_message$attachments","_message$user2","groupedByUser","propGroupedByUser","message","propMessage","contextGroupedByUser","contextMessage","userLanguage","undefined","handleDelete","role","messageTextToRender","i18n","text","renderedText","mentioned_users","user","id","userColor","messageActionsHandler","canDelete","images","attachments","filter","_ref","type","createElement","className","isMyMessage","key","image","name","style","color","deleted_at","Fragment","customWrapperClass","mine","customClass","FixedHeightMessage","memo"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/Message/FixedHeightMessage.js"],"sourcesContent":["import React, { useCallback, useMemo } from 'react';\nimport { useDeleteHandler, useUserRole } from './hooks';\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageTimestamp } from './MessageTimestamp';\nimport { getMessageActions } from './utils';\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport { MessageActions } from '../MessageActions';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText } from './renderText';\nconst selectColor = (number, dark) => {\n    const hue = number * 137.508; // use golden angle approximation\n    return `hsl(${hue},${dark ? '50%' : '85%'}, ${dark ? '75%' : '55%'})`;\n};\nconst hashUserId = (userId) => {\n    const hash = userId.split('').reduce((acc, c) => {\n        acc = (acc << 5) - acc + c.charCodeAt(0);\n        return acc & acc;\n    }, 0);\n    return Math.abs(hash) / 10 ** Math.ceil(Math.log10(Math.abs(hash) + 1));\n};\nconst getUserColor = (theme, userId) => selectColor(hashUserId(userId), theme.includes('dark'));\nconst UnMemoizedFixedHeightMessage = (props) => {\n    const { groupedByUser: propGroupedByUser, message: propMessage } = props;\n    const { theme } = useChatContext('FixedHeightMessage');\n    const { groupedByUser: contextGroupedByUser, message: contextMessage } = useMessageContext('FixedHeightMessage');\n    const { MessageDeleted = DefaultMessageDeleted } = useComponentContext('FixedHeightMessage');\n    const { userLanguage } = useTranslationContext('FixedHeightMessage');\n    const groupedByUser = propGroupedByUser !== undefined ? propGroupedByUser : contextGroupedByUser;\n    const message = propMessage || contextMessage;\n    const handleDelete = useDeleteHandler(message);\n    const role = useUserRole(message);\n    const messageTextToRender = message?.i18n?.[`${userLanguage}_text`] ||\n        message?.text;\n    const renderedText = useMemo(() => renderText(messageTextToRender, message.mentioned_users), [message.mentioned_users, messageTextToRender]);\n    const userId = message.user?.id || '';\n    const userColor = useMemo(() => getUserColor(theme, userId), [userId, theme]);\n    const messageActionsHandler = useCallback(() => getMessageActions(['delete'], { canDelete: role.canDelete }), [role]);\n    const images = message?.attachments?.filter(({ type }) => type === 'image');\n    return (React.createElement(\"div\", { className: `str-chat__virtual-message__wrapper ${role.isMyMessage ? 'str-chat__virtual-message__wrapper--me' : ''} ${groupedByUser ? 'str-chat__virtual-message__wrapper--group' : ''}`, key: message.id },\n        message.user && (React.createElement(Avatar, { image: message.user.image, name: message.user.name || message.user.id, user: message.user })),\n        React.createElement(\"div\", { className: 'str-chat__virtual-message__content' },\n            React.createElement(\"div\", { className: 'str-chat__virtual-message__meta' },\n                React.createElement(\"div\", { className: 'str-chat__virtual-message__author', style: { color: userColor } },\n                    React.createElement(\"strong\", null, message.user?.name || 'unknown'))),\n            message.deleted_at || message.type === 'deleted' ? (React.createElement(MessageDeleted, { message: message })) : (React.createElement(React.Fragment, null,\n                images && React.createElement(Gallery, { images: images }),\n                React.createElement(\"div\", { className: 'str-chat__virtual-message__text', \"data-testid\": 'msg-text' },\n                    renderedText,\n                    React.createElement(\"div\", { className: 'str-chat__virtual-message__data' },\n                        React.createElement(MessageActions, { customWrapperClass: 'str-chat__virtual-message__actions', getMessageActions: messageActionsHandler, handleDelete: handleDelete, message: message, mine: () => role.isMyMessage }),\n                        React.createElement(\"span\", { className: 'str-chat__virtual-message__date' },\n                            React.createElement(MessageTimestamp, { customClass: 'str-chat__message-simple-timestamp', message: message })))))))));\n};\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * FixedHeightMessage - This component renders a single message.\n * It uses fixed height elements to make sure it works well in VirtualizedMessageList\n */\nexport const FixedHeightMessage = React.memo(UnMemoizedFixedHeightMessage);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}