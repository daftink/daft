{"ast":null,"code":"import * as linkify from 'linkifyjs';\nexport const getImageAttachmentConfiguration = (attachment, element) => {\n  let newUrl = undefined;\n  const urlToTest = attachment.image_url || attachment.thumb_url || '';\n  if (linkify.test(urlToTest, 'url')) {\n    const url = new URL(urlToTest);\n    const resizeDimensions = getSizingRestrictions(url, element);\n    if (resizeDimensions) {\n      // Apply 2x for retina displays\n      resizeDimensions.height *= 2;\n      resizeDimensions.width *= 2;\n      addResizingParamsToUrl(resizeDimensions, url);\n    }\n    newUrl = url.href;\n  }\n  return {\n    url: newUrl || ''\n  };\n};\nexport const getVideoAttachmentConfiguration = (attachment, element, shouldGenerateVideoThumbnail) => {\n  let thumbUrl = undefined;\n  if (attachment.thumb_url && shouldGenerateVideoThumbnail && linkify.test(attachment.thumb_url, 'url')) {\n    const url = new URL(attachment.thumb_url);\n    const resizeDimensions = getSizingRestrictions(url, element);\n    if (resizeDimensions) {\n      // Apply 2x for retina displays\n      resizeDimensions.height *= 2;\n      resizeDimensions.width *= 2;\n      addResizingParamsToUrl(resizeDimensions, url);\n    }\n    thumbUrl = url.href;\n  }\n  return {\n    thumbUrl,\n    url: attachment.asset_url || ''\n  };\n};\nconst getSizingRestrictions = (url, htmlElement) => {\n  const urlParams = url.searchParams;\n  const originalHeight = Number(urlParams.get('oh')) || 1;\n  const originalWidth = Number(urlParams.get('ow')) || 1;\n  const cssSizeRestriction = getCSSSizeRestrictions(htmlElement);\n  let resizeDimensions;\n  if ((cssSizeRestriction.maxHeight || cssSizeRestriction.height) && cssSizeRestriction.maxWidth) {\n    resizeDimensions = getResizeDimensions(originalHeight, originalWidth, /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n    cssSizeRestriction.maxHeight || cssSizeRestriction.height, cssSizeRestriction.maxWidth);\n  } else {\n    resizeDimensions = undefined;\n  }\n  return resizeDimensions;\n};\nconst getResizeDimensions = (originalHeight, originalWidth, maxHeight, maxWidth) => ({\n  height: Math.round(Math.max(maxHeight, maxWidth / originalWidth * originalHeight)),\n  width: Math.round(Math.max(maxHeight, maxWidth / originalHeight * originalWidth))\n});\nconst getCSSSizeRestrictions = htmlElement => {\n  const computedStylesheet = getComputedStyle(htmlElement);\n  const height = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('height'));\n  const maxHeight = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('max-height'));\n  const maxWidth = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('max-width'));\n  if (!((height || maxHeight) && maxWidth)) {\n    console.warn(\"Invalid value set for height/max-height and/or max-width for HTML element, this can cause scrolling issues inside the message list, more info https://getstream.io/chat/docs/sdk/react/message-components/attachment/#image-and-video-sizing\");\n  }\n  return {\n    height,\n    maxHeight,\n    maxWidth\n  };\n};\nconst getValueRepresentationOfCSSProperty = property => {\n  if (!property.endsWith('px')) {\n    return undefined;\n  }\n  const number = parseFloat(property);\n  return isNaN(number) ? undefined : number;\n};\nconst addResizingParamsToUrl = (resizeDimensions, url) => {\n  url.searchParams.set('h', resizeDimensions.height.toString());\n  url.searchParams.set('w', resizeDimensions.width.toString());\n};","map":{"version":3,"names":["linkify","getImageAttachmentConfiguration","attachment","element","newUrl","undefined","urlToTest","image_url","thumb_url","test","url","URL","resizeDimensions","getSizingRestrictions","height","width","addResizingParamsToUrl","href","getVideoAttachmentConfiguration","shouldGenerateVideoThumbnail","thumbUrl","asset_url","htmlElement","urlParams","searchParams","originalHeight","Number","get","originalWidth","cssSizeRestriction","getCSSSizeRestrictions","maxHeight","maxWidth","getResizeDimensions","Math","round","max","computedStylesheet","getComputedStyle","getValueRepresentationOfCSSProperty","getPropertyValue","console","warn","property","endsWith","number","parseFloat","isNaN","set","toString"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/Attachment/attachment-sizing.js"],"sourcesContent":["import * as linkify from 'linkifyjs';\nexport const getImageAttachmentConfiguration = (attachment, element) => {\n    let newUrl = undefined;\n    const urlToTest = attachment.image_url || attachment.thumb_url || '';\n    if (linkify.test(urlToTest, 'url')) {\n        const url = new URL(urlToTest);\n        const resizeDimensions = getSizingRestrictions(url, element);\n        if (resizeDimensions) {\n            // Apply 2x for retina displays\n            resizeDimensions.height *= 2;\n            resizeDimensions.width *= 2;\n            addResizingParamsToUrl(resizeDimensions, url);\n        }\n        newUrl = url.href;\n    }\n    return {\n        url: newUrl || '',\n    };\n};\nexport const getVideoAttachmentConfiguration = (attachment, element, shouldGenerateVideoThumbnail) => {\n    let thumbUrl = undefined;\n    if (attachment.thumb_url &&\n        shouldGenerateVideoThumbnail &&\n        linkify.test(attachment.thumb_url, 'url')) {\n        const url = new URL(attachment.thumb_url);\n        const resizeDimensions = getSizingRestrictions(url, element);\n        if (resizeDimensions) {\n            // Apply 2x for retina displays\n            resizeDimensions.height *= 2;\n            resizeDimensions.width *= 2;\n            addResizingParamsToUrl(resizeDimensions, url);\n        }\n        thumbUrl = url.href;\n    }\n    return {\n        thumbUrl,\n        url: attachment.asset_url || '',\n    };\n};\nconst getSizingRestrictions = (url, htmlElement) => {\n    const urlParams = url.searchParams;\n    const originalHeight = Number(urlParams.get('oh')) || 1;\n    const originalWidth = Number(urlParams.get('ow')) || 1;\n    const cssSizeRestriction = getCSSSizeRestrictions(htmlElement);\n    let resizeDimensions;\n    if ((cssSizeRestriction.maxHeight || cssSizeRestriction.height) &&\n        cssSizeRestriction.maxWidth) {\n        resizeDimensions = getResizeDimensions(originalHeight, originalWidth, \n        /* eslint-disable-next-line @typescript-eslint/no-non-null-assertion */\n        cssSizeRestriction.maxHeight || cssSizeRestriction.height, cssSizeRestriction.maxWidth);\n    }\n    else {\n        resizeDimensions = undefined;\n    }\n    return resizeDimensions;\n};\nconst getResizeDimensions = (originalHeight, originalWidth, maxHeight, maxWidth) => ({\n    height: Math.round(Math.max(maxHeight, (maxWidth / originalWidth) * originalHeight)),\n    width: Math.round(Math.max(maxHeight, (maxWidth / originalHeight) * originalWidth)),\n});\nconst getCSSSizeRestrictions = (htmlElement) => {\n    const computedStylesheet = getComputedStyle(htmlElement);\n    const height = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('height'));\n    const maxHeight = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('max-height'));\n    const maxWidth = getValueRepresentationOfCSSProperty(computedStylesheet.getPropertyValue('max-width'));\n    if (!((height || maxHeight) && maxWidth)) {\n        console.warn(`Invalid value set for height/max-height and/or max-width for HTML element, this can cause scrolling issues inside the message list, more info https://getstream.io/chat/docs/sdk/react/message-components/attachment/#image-and-video-sizing`);\n    }\n    return { height, maxHeight, maxWidth };\n};\nconst getValueRepresentationOfCSSProperty = (property) => {\n    if (!property.endsWith('px')) {\n        return undefined;\n    }\n    const number = parseFloat(property);\n    return isNaN(number) ? undefined : number;\n};\nconst addResizingParamsToUrl = (resizeDimensions, url) => {\n    url.searchParams.set('h', resizeDimensions.height.toString());\n    url.searchParams.set('w', resizeDimensions.width.toString());\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}