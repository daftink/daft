{"ast":null,"code":"import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { ThreadProvider } from '../Threads';\nimport { Icon } from '../Threads/icons';\nimport { UnreadCountBadge } from '../Threads/UnreadCountBadge';\nimport { useChatContext } from '../../context';\nimport { useStateStore } from '../../store';\nimport clsx from 'clsx';\nconst ChatViewContext = createContext({\n  activeChatView: 'channels',\n  setActiveChatView: () => undefined\n});\nexport const ChatView = _ref => {\n  let {\n    children\n  } = _ref;\n  const [activeChatView, setActiveChatView] = useState('channels');\n  const {\n    theme\n  } = useChatContext();\n  const value = useMemo(() => ({\n    activeChatView,\n    setActiveChatView\n  }), [activeChatView]);\n  return React.createElement(ChatViewContext.Provider, {\n    value: value\n  }, React.createElement(\"div\", {\n    className: clsx('str-chat', theme, 'str-chat__chat-view')\n  }, children));\n};\nconst ChannelsView = _ref2 => {\n  let {\n    children\n  } = _ref2;\n  const {\n    activeChatView\n  } = useContext(ChatViewContext);\n  if (activeChatView !== 'channels') return null;\n  return React.createElement(\"div\", {\n    className: 'str-chat__chat-view__channels'\n  }, children);\n};\nconst ThreadsViewContext = createContext({\n  activeThread: undefined,\n  setActiveThread: () => undefined\n});\nexport const useThreadsViewContext = () => useContext(ThreadsViewContext);\nconst ThreadsView = _ref3 => {\n  let {\n    children\n  } = _ref3;\n  const {\n    activeChatView\n  } = useContext(ChatViewContext);\n  const [activeThread, setActiveThread] = useState(undefined);\n  const value = useMemo(() => ({\n    activeThread,\n    setActiveThread\n  }), [activeThread]);\n  if (activeChatView !== 'threads') return null;\n  return React.createElement(ThreadsViewContext.Provider, {\n    value: value\n  }, React.createElement(\"div\", {\n    className: 'str-chat__chat-view__threads'\n  }, children));\n};\n// thread business logic that's impossible to keep within client but encapsulated for ease of use\nexport const useActiveThread = _ref4 => {\n  let {\n    activeThread\n  } = _ref4;\n  useEffect(() => {\n    if (!activeThread) return;\n    const handleVisibilityChange = () => {\n      if (document.visibilityState === 'visible' && document.hasFocus()) {\n        activeThread.activate();\n      }\n      if (document.visibilityState === 'hidden' || !document.hasFocus()) {\n        activeThread.deactivate();\n      }\n    };\n    handleVisibilityChange();\n    window.addEventListener('focus', handleVisibilityChange);\n    window.addEventListener('blur', handleVisibilityChange);\n    return () => {\n      activeThread.deactivate();\n      window.addEventListener('blur', handleVisibilityChange);\n      window.removeEventListener('focus', handleVisibilityChange);\n    };\n  }, [activeThread]);\n};\n// ThreadList under View.Threads context, will access setting function and on item click will set activeThread\n// which can be accessed for the ease of use by ThreadAdapter which forwards it to required ThreadProvider\n// ThreadList can easily live without this context and click handler can be overriden, ThreadAdapter is then no longer needed\n/**\n * // this setup still works\n * const MyCustomComponent = () => {\n *  const [activeThread, setActiveThread] = useState();\n *\n *  return <>\n *    // simplified\n *    <ThreadList onItemPointerDown={setActiveThread} />\n *    <ThreadProvider thread={activeThread}>\n *      <Thread />\n *    </ThreadProvider>\n *  </>\n * }\n *\n */\nconst ThreadAdapter = _ref5 => {\n  let {\n    children\n  } = _ref5;\n  const {\n    activeThread\n  } = useThreadsViewContext();\n  useActiveThread({\n    activeThread\n  });\n  return React.createElement(ThreadProvider, {\n    thread: activeThread\n  }, children);\n};\nconst selector = _ref6 => {\n  let {\n    unreadThreadCount\n  } = _ref6;\n  return {\n    unreadThreadCount\n  };\n};\nconst ChatViewSelector = () => {\n  const {\n    client\n  } = useChatContext();\n  const {\n    unreadThreadCount\n  } = useStateStore(client.threads.state, selector);\n  const {\n    activeChatView,\n    setActiveChatView\n  } = useContext(ChatViewContext);\n  return React.createElement(\"div\", {\n    className: 'str-chat__chat-view__selector'\n  }, React.createElement(\"button\", {\n    \"aria-selected\": activeChatView === 'channels',\n    className: 'str-chat__chat-view__selector-button',\n    onPointerDown: () => setActiveChatView('channels'),\n    role: 'tab'\n  }, React.createElement(Icon.MessageBubbleEmpty, null), React.createElement(\"div\", {\n    className: 'str-chat__chat-view__selector-button-text'\n  }, \"Channels\")), React.createElement(\"button\", {\n    \"aria-selected\": activeChatView === 'threads',\n    className: 'str-chat__chat-view__selector-button',\n    onPointerDown: () => setActiveChatView('threads'),\n    role: 'tab'\n  }, React.createElement(UnreadCountBadge, {\n    count: unreadThreadCount,\n    position: 'top-right'\n  }, React.createElement(Icon.MessageBubble, null)), React.createElement(\"div\", {\n    className: 'str-chat__chat-view__selector-button-text'\n  }, \"Threads\")));\n};\nChatView.Channels = ChannelsView;\nChatView.Threads = ThreadsView;\nChatView.ThreadAdapter = ThreadAdapter;\nChatView.Selector = ChatViewSelector;","map":{"version":3,"names":["React","createContext","useContext","useEffect","useMemo","useState","ThreadProvider","Icon","UnreadCountBadge","useChatContext","useStateStore","clsx","ChatViewContext","activeChatView","setActiveChatView","undefined","ChatView","_ref","children","theme","value","createElement","Provider","className","ChannelsView","_ref2","ThreadsViewContext","activeThread","setActiveThread","useThreadsViewContext","ThreadsView","_ref3","useActiveThread","_ref4","handleVisibilityChange","document","visibilityState","hasFocus","activate","deactivate","window","addEventListener","removeEventListener","ThreadAdapter","_ref5","thread","selector","_ref6","unreadThreadCount","ChatViewSelector","client","threads","state","onPointerDown","role","MessageBubbleEmpty","count","position","MessageBubble","Channels","Threads","Selector"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/ChatView/ChatView.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { ThreadProvider } from '../Threads';\nimport { Icon } from '../Threads/icons';\nimport { UnreadCountBadge } from '../Threads/UnreadCountBadge';\nimport { useChatContext } from '../../context';\nimport { useStateStore } from '../../store';\nimport clsx from 'clsx';\nconst ChatViewContext = createContext({\n    activeChatView: 'channels',\n    setActiveChatView: () => undefined,\n});\nexport const ChatView = ({ children }) => {\n    const [activeChatView, setActiveChatView] = useState('channels');\n    const { theme } = useChatContext();\n    const value = useMemo(() => ({ activeChatView, setActiveChatView }), [activeChatView]);\n    return (React.createElement(ChatViewContext.Provider, { value: value },\n        React.createElement(\"div\", { className: clsx('str-chat', theme, 'str-chat__chat-view') }, children)));\n};\nconst ChannelsView = ({ children }) => {\n    const { activeChatView } = useContext(ChatViewContext);\n    if (activeChatView !== 'channels')\n        return null;\n    return React.createElement(\"div\", { className: 'str-chat__chat-view__channels' }, children);\n};\nconst ThreadsViewContext = createContext({\n    activeThread: undefined,\n    setActiveThread: () => undefined,\n});\nexport const useThreadsViewContext = () => useContext(ThreadsViewContext);\nconst ThreadsView = ({ children }) => {\n    const { activeChatView } = useContext(ChatViewContext);\n    const [activeThread, setActiveThread] = useState(undefined);\n    const value = useMemo(() => ({ activeThread, setActiveThread }), [activeThread]);\n    if (activeChatView !== 'threads')\n        return null;\n    return (React.createElement(ThreadsViewContext.Provider, { value: value },\n        React.createElement(\"div\", { className: 'str-chat__chat-view__threads' }, children)));\n};\n// thread business logic that's impossible to keep within client but encapsulated for ease of use\nexport const useActiveThread = ({ activeThread }) => {\n    useEffect(() => {\n        if (!activeThread)\n            return;\n        const handleVisibilityChange = () => {\n            if (document.visibilityState === 'visible' && document.hasFocus()) {\n                activeThread.activate();\n            }\n            if (document.visibilityState === 'hidden' || !document.hasFocus()) {\n                activeThread.deactivate();\n            }\n        };\n        handleVisibilityChange();\n        window.addEventListener('focus', handleVisibilityChange);\n        window.addEventListener('blur', handleVisibilityChange);\n        return () => {\n            activeThread.deactivate();\n            window.addEventListener('blur', handleVisibilityChange);\n            window.removeEventListener('focus', handleVisibilityChange);\n        };\n    }, [activeThread]);\n};\n// ThreadList under View.Threads context, will access setting function and on item click will set activeThread\n// which can be accessed for the ease of use by ThreadAdapter which forwards it to required ThreadProvider\n// ThreadList can easily live without this context and click handler can be overriden, ThreadAdapter is then no longer needed\n/**\n * // this setup still works\n * const MyCustomComponent = () => {\n *  const [activeThread, setActiveThread] = useState();\n *\n *  return <>\n *    // simplified\n *    <ThreadList onItemPointerDown={setActiveThread} />\n *    <ThreadProvider thread={activeThread}>\n *      <Thread />\n *    </ThreadProvider>\n *  </>\n * }\n *\n */\nconst ThreadAdapter = ({ children }) => {\n    const { activeThread } = useThreadsViewContext();\n    useActiveThread({ activeThread });\n    return React.createElement(ThreadProvider, { thread: activeThread }, children);\n};\nconst selector = ({ unreadThreadCount }) => ({\n    unreadThreadCount,\n});\nconst ChatViewSelector = () => {\n    const { client } = useChatContext();\n    const { unreadThreadCount } = useStateStore(client.threads.state, selector);\n    const { activeChatView, setActiveChatView } = useContext(ChatViewContext);\n    return (React.createElement(\"div\", { className: 'str-chat__chat-view__selector' },\n        React.createElement(\"button\", { \"aria-selected\": activeChatView === 'channels', className: 'str-chat__chat-view__selector-button', onPointerDown: () => setActiveChatView('channels'), role: 'tab' },\n            React.createElement(Icon.MessageBubbleEmpty, null),\n            React.createElement(\"div\", { className: 'str-chat__chat-view__selector-button-text' }, \"Channels\")),\n        React.createElement(\"button\", { \"aria-selected\": activeChatView === 'threads', className: 'str-chat__chat-view__selector-button', onPointerDown: () => setActiveChatView('threads'), role: 'tab' },\n            React.createElement(UnreadCountBadge, { count: unreadThreadCount, position: 'top-right' },\n                React.createElement(Icon.MessageBubble, null)),\n            React.createElement(\"div\", { className: 'str-chat__chat-view__selector-button-text' }, \"Threads\"))));\n};\nChatView.Channels = ChannelsView;\nChatView.Threads = ThreadsView;\nChatView.ThreadAdapter = ThreadAdapter;\nChatView.Selector = ChatViewSelector;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}