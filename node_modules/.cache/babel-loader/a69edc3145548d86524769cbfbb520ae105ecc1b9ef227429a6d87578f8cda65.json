{"ast":null,"code":"import _objectSpread from \"/tmp/daft-chat-temp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport React, { useEffect } from 'react';\nimport { MessageInputFlat } from './MessageInputFlat';\nimport { useMessageComposer } from './hooks';\nimport { useCooldownTimer } from './hooks/useCooldownTimer';\nimport { useCreateMessageInputContext } from './hooks/useCreateMessageInputContext';\nimport { useMessageInputControls } from './hooks/useMessageInputControls';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageInputContextProvider } from '../../context/MessageInputContext';\nimport { DialogManagerProvider } from '../../context';\nimport { useStableId } from '../UtilityComponents/useStableId';\nimport { useRegisterDropHandlers } from './WithDragAndDropUpload';\nconst MessageInputProvider = props => {\n  var _props$emojiSearchInd;\n  const cooldownTimerState = useCooldownTimer();\n  const messageInputUiApi = useMessageInputControls(props);\n  const {\n    emojiSearchIndex\n  } = useComponentContext('MessageInput');\n  const messageInputContextValue = useCreateMessageInputContext(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, cooldownTimerState), messageInputUiApi), props), {}, {\n    emojiSearchIndex: (_props$emojiSearchInd = props.emojiSearchIndex) !== null && _props$emojiSearchInd !== void 0 ? _props$emojiSearchInd : emojiSearchIndex\n  }));\n  const messageComposer = useMessageComposer();\n  useEffect(() => () => {\n    messageComposer.createDraft();\n  }, [messageComposer]);\n  useEffect(() => {\n    const threadId = messageComposer.threadId;\n    if (!threadId || !messageComposer.channel || !messageComposer.compositionIsEmpty) return;\n    // get draft data for legacy thead composer\n    messageComposer.channel.getDraft({\n      parent_id: threadId\n    }).then(_ref => {\n      let {\n        draft\n      } = _ref;\n      if (draft) {\n        messageComposer.initState({\n          composition: draft\n        });\n      }\n    });\n  }, [messageComposer]);\n  useRegisterDropHandlers();\n  return React.createElement(MessageInputContextProvider, {\n    value: messageInputContextValue\n  }, props.children);\n};\nconst UnMemoizedMessageInput = props => {\n  const {\n    Input: PropInput\n  } = props;\n  const {\n    Input: ContextInput\n  } = useComponentContext('MessageInput');\n  const id = useStableId();\n  const Input = PropInput || ContextInput || MessageInputFlat;\n  const dialogManagerId = props.isThreadInput ? \"message-input-dialog-manager-thread-\".concat(id) : \"message-input-dialog-manager-\".concat(id);\n  return React.createElement(DialogManagerProvider, {\n    id: dialogManagerId\n  }, React.createElement(MessageInputProvider, _objectSpread({}, props), React.createElement(Input, null)));\n};\n/**\n * A high level component that has provides all functionality to the Input it renders.\n */\nexport const MessageInput = React.memo(UnMemoizedMessageInput);","map":{"version":3,"names":["React","useEffect","MessageInputFlat","useMessageComposer","useCooldownTimer","useCreateMessageInputContext","useMessageInputControls","useComponentContext","MessageInputContextProvider","DialogManagerProvider","useStableId","useRegisterDropHandlers","MessageInputProvider","props","_props$emojiSearchInd","cooldownTimerState","messageInputUiApi","emojiSearchIndex","messageInputContextValue","_objectSpread","messageComposer","createDraft","threadId","channel","compositionIsEmpty","getDraft","parent_id","then","_ref","draft","initState","composition","createElement","value","children","UnMemoizedMessageInput","Input","PropInput","ContextInput","id","dialogManagerId","isThreadInput","concat","MessageInput","memo"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/MessageInput/MessageInput.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { MessageInputFlat } from './MessageInputFlat';\nimport { useMessageComposer } from './hooks';\nimport { useCooldownTimer } from './hooks/useCooldownTimer';\nimport { useCreateMessageInputContext } from './hooks/useCreateMessageInputContext';\nimport { useMessageInputControls } from './hooks/useMessageInputControls';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageInputContextProvider } from '../../context/MessageInputContext';\nimport { DialogManagerProvider } from '../../context';\nimport { useStableId } from '../UtilityComponents/useStableId';\nimport { useRegisterDropHandlers } from './WithDragAndDropUpload';\nconst MessageInputProvider = (props) => {\n    const cooldownTimerState = useCooldownTimer();\n    const messageInputUiApi = useMessageInputControls(props);\n    const { emojiSearchIndex } = useComponentContext('MessageInput');\n    const messageInputContextValue = useCreateMessageInputContext({\n        ...cooldownTimerState,\n        ...messageInputUiApi,\n        ...props,\n        emojiSearchIndex: props.emojiSearchIndex ?? emojiSearchIndex,\n    });\n    const messageComposer = useMessageComposer();\n    useEffect(() => () => {\n        messageComposer.createDraft();\n    }, [messageComposer]);\n    useEffect(() => {\n        const threadId = messageComposer.threadId;\n        if (!threadId || !messageComposer.channel || !messageComposer.compositionIsEmpty)\n            return;\n        // get draft data for legacy thead composer\n        messageComposer.channel.getDraft({ parent_id: threadId }).then(({ draft }) => {\n            if (draft) {\n                messageComposer.initState({ composition: draft });\n            }\n        });\n    }, [messageComposer]);\n    useRegisterDropHandlers();\n    return (React.createElement(MessageInputContextProvider, { value: messageInputContextValue }, props.children));\n};\nconst UnMemoizedMessageInput = (props) => {\n    const { Input: PropInput } = props;\n    const { Input: ContextInput } = useComponentContext('MessageInput');\n    const id = useStableId();\n    const Input = PropInput || ContextInput || MessageInputFlat;\n    const dialogManagerId = props.isThreadInput\n        ? `message-input-dialog-manager-thread-${id}`\n        : `message-input-dialog-manager-${id}`;\n    return (React.createElement(DialogManagerProvider, { id: dialogManagerId },\n        React.createElement(MessageInputProvider, { ...props },\n            React.createElement(Input, null))));\n};\n/**\n * A high level component that has provides all functionality to the Input it renders.\n */\nexport const MessageInput = React.memo(UnMemoizedMessageInput);\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,kBAAkB,QAAQ,SAAS;AAC5C,SAASC,gBAAgB,QAAQ,0BAA0B;AAC3D,SAASC,4BAA4B,QAAQ,sCAAsC;AACnF,SAASC,uBAAuB,QAAQ,iCAAiC;AACzE,SAASC,mBAAmB,QAAQ,gCAAgC;AACpE,SAASC,2BAA2B,QAAQ,mCAAmC;AAC/E,SAASC,qBAAqB,QAAQ,eAAe;AACrD,SAASC,WAAW,QAAQ,kCAAkC;AAC9D,SAASC,uBAAuB,QAAQ,yBAAyB;AACjE,MAAMC,oBAAoB,GAAIC,KAAK,IAAK;EAAA,IAAAC,qBAAA;EACpC,MAAMC,kBAAkB,GAAGX,gBAAgB,CAAC,CAAC;EAC7C,MAAMY,iBAAiB,GAAGV,uBAAuB,CAACO,KAAK,CAAC;EACxD,MAAM;IAAEI;EAAiB,CAAC,GAAGV,mBAAmB,CAAC,cAAc,CAAC;EAChE,MAAMW,wBAAwB,GAAGb,4BAA4B,CAAAc,aAAA,CAAAA,aAAA,CAAAA,aAAA,CAAAA,aAAA,KACtDJ,kBAAkB,GAClBC,iBAAiB,GACjBH,KAAK;IACRI,gBAAgB,GAAAH,qBAAA,GAAED,KAAK,CAACI,gBAAgB,cAAAH,qBAAA,cAAAA,qBAAA,GAAIG;EAAgB,EAC/D,CAAC;EACF,MAAMG,eAAe,GAAGjB,kBAAkB,CAAC,CAAC;EAC5CF,SAAS,CAAC,MAAM,MAAM;IAClBmB,eAAe,CAACC,WAAW,CAAC,CAAC;EACjC,CAAC,EAAE,CAACD,eAAe,CAAC,CAAC;EACrBnB,SAAS,CAAC,MAAM;IACZ,MAAMqB,QAAQ,GAAGF,eAAe,CAACE,QAAQ;IACzC,IAAI,CAACA,QAAQ,IAAI,CAACF,eAAe,CAACG,OAAO,IAAI,CAACH,eAAe,CAACI,kBAAkB,EAC5E;IACJ;IACAJ,eAAe,CAACG,OAAO,CAACE,QAAQ,CAAC;MAAEC,SAAS,EAAEJ;IAAS,CAAC,CAAC,CAACK,IAAI,CAACC,IAAA,IAAe;MAAA,IAAd;QAAEC;MAAM,CAAC,GAAAD,IAAA;MACrE,IAAIC,KAAK,EAAE;QACPT,eAAe,CAACU,SAAS,CAAC;UAAEC,WAAW,EAAEF;QAAM,CAAC,CAAC;MACrD;IACJ,CAAC,CAAC;EACN,CAAC,EAAE,CAACT,eAAe,CAAC,CAAC;EACrBT,uBAAuB,CAAC,CAAC;EACzB,OAAQX,KAAK,CAACgC,aAAa,CAACxB,2BAA2B,EAAE;IAAEyB,KAAK,EAAEf;EAAyB,CAAC,EAAEL,KAAK,CAACqB,QAAQ,CAAC;AACjH,CAAC;AACD,MAAMC,sBAAsB,GAAItB,KAAK,IAAK;EACtC,MAAM;IAAEuB,KAAK,EAAEC;EAAU,CAAC,GAAGxB,KAAK;EAClC,MAAM;IAAEuB,KAAK,EAAEE;EAAa,CAAC,GAAG/B,mBAAmB,CAAC,cAAc,CAAC;EACnE,MAAMgC,EAAE,GAAG7B,WAAW,CAAC,CAAC;EACxB,MAAM0B,KAAK,GAAGC,SAAS,IAAIC,YAAY,IAAIpC,gBAAgB;EAC3D,MAAMsC,eAAe,GAAG3B,KAAK,CAAC4B,aAAa,0CAAAC,MAAA,CACEH,EAAE,oCAAAG,MAAA,CACTH,EAAE,CAAE;EAC1C,OAAQvC,KAAK,CAACgC,aAAa,CAACvB,qBAAqB,EAAE;IAAE8B,EAAE,EAAEC;EAAgB,CAAC,EACtExC,KAAK,CAACgC,aAAa,CAACpB,oBAAoB,EAAAO,aAAA,KAAON,KAAK,GAChDb,KAAK,CAACgC,aAAa,CAACI,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;AAC9C,CAAC;AACD;AACA;AACA;AACA,OAAO,MAAMO,YAAY,GAAG3C,KAAK,CAAC4C,IAAI,CAACT,sBAAsB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}