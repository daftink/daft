{"ast":null,"code":"import _objectSpread from \"/tmp/daft-chat-temp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/tmp/daft-chat-temp/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"children\", \"className\", \"placement\", \"Submenu\", \"submenuContainerProps\"];\nimport clsx from 'clsx';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDialog, useDialogIsOpen } from './hooks';\nimport { useDialogAnchor } from './DialogAnchor';\nexport const ButtonWithSubmenu = _ref => {\n  let {\n      children,\n      className,\n      placement,\n      Submenu,\n      submenuContainerProps\n    } = _ref,\n    buttonProps = _objectWithoutProperties(_ref, _excluded);\n  const buttonRef = useRef(null);\n  const [dialogContainer, setDialogContainer] = useState(null);\n  const keepSubmenuOpen = useRef(false);\n  const dialogCloseTimeout = useRef(null);\n  const dialogId = useMemo(() => \"submenu-\".concat(Math.random().toString(36).slice(2)), []);\n  const dialog = useDialog({\n    id: dialogId\n  });\n  const dialogIsOpen = useDialogIsOpen(dialogId);\n  const {\n    attributes,\n    setPopperElement,\n    styles\n  } = useDialogAnchor({\n    open: dialogIsOpen,\n    placement,\n    referenceElement: buttonRef.current\n  });\n  const closeDialogLazily = useCallback(() => {\n    if (dialogCloseTimeout.current) clearTimeout(dialogCloseTimeout.current);\n    dialogCloseTimeout.current = setTimeout(() => {\n      if (keepSubmenuOpen.current) return;\n      dialog.close();\n    }, 100);\n  }, [dialog]);\n  const handleClose = useCallback(event => {\n    const parentButton = buttonRef.current;\n    if (!dialogIsOpen || !parentButton) return;\n    event.stopPropagation();\n    closeDialogLazily();\n    parentButton.focus();\n  }, [closeDialogLazily, dialogIsOpen, buttonRef]);\n  const handleFocusParentButton = () => {\n    if (dialogIsOpen) return;\n    dialog.open();\n    keepSubmenuOpen.current = true;\n  };\n  useEffect(() => {\n    const parentButton = buttonRef.current;\n    if (!dialogIsOpen || !parentButton) return;\n    const hideOnEscape = event => {\n      if (event.key !== 'Escape') return;\n      handleClose(event);\n      keepSubmenuOpen.current = false;\n    };\n    document.addEventListener('keyup', hideOnEscape, {\n      capture: true\n    });\n    return () => {\n      document.removeEventListener('keyup', hideOnEscape, {\n        capture: true\n      });\n    };\n  }, [dialogIsOpen, handleClose]);\n  return React.createElement(React.Fragment, null, React.createElement(\"button\", _objectSpread({\n    \"aria-selected\": 'false',\n    className: clsx(className, 'str_chat__button-with-submenu', {\n      'str_chat__button-with-submenu--submenu-open': dialogIsOpen\n    }),\n    onBlur: () => {\n      keepSubmenuOpen.current = false;\n      closeDialogLazily();\n    },\n    onClick: event => {\n      event.stopPropagation();\n      dialog.toggle();\n    },\n    onFocus: handleFocusParentButton,\n    onMouseEnter: handleFocusParentButton,\n    onMouseLeave: () => {\n      keepSubmenuOpen.current = false;\n      closeDialogLazily();\n    },\n    ref: buttonRef,\n    role: 'option'\n  }, buttonProps), children), dialogIsOpen && React.createElement(\"div\", _objectSpread(_objectSpread({}, attributes.popper), {}, {\n    onBlur: event => {\n      const isBlurredDescendant = event.relatedTarget instanceof Node && (dialogContainer === null || dialogContainer === void 0 ? void 0 : dialogContainer.contains(event.relatedTarget));\n      if (isBlurredDescendant) return;\n      keepSubmenuOpen.current = false;\n      closeDialogLazily();\n    },\n    onFocus: () => {\n      keepSubmenuOpen.current = true;\n    },\n    onMouseEnter: () => {\n      keepSubmenuOpen.current = true;\n    },\n    onMouseLeave: () => {\n      keepSubmenuOpen.current = false;\n      closeDialogLazily();\n    },\n    ref: element => {\n      setPopperElement(element);\n      setDialogContainer(element);\n    },\n    style: styles.popper,\n    tabIndex: -1\n  }, submenuContainerProps), React.createElement(Submenu, null)));\n};","map":{"version":3,"names":["clsx","React","useCallback","useEffect","useMemo","useRef","useState","useDialog","useDialogIsOpen","useDialogAnchor","ButtonWithSubmenu","_ref","children","className","placement","Submenu","submenuContainerProps","buttonProps","_objectWithoutProperties","_excluded","buttonRef","dialogContainer","setDialogContainer","keepSubmenuOpen","dialogCloseTimeout","dialogId","concat","Math","random","toString","slice","dialog","id","dialogIsOpen","attributes","setPopperElement","styles","open","referenceElement","current","closeDialogLazily","clearTimeout","setTimeout","close","handleClose","event","parentButton","stopPropagation","focus","handleFocusParentButton","hideOnEscape","key","document","addEventListener","capture","removeEventListener","createElement","Fragment","_objectSpread","onBlur","onClick","toggle","onFocus","onMouseEnter","onMouseLeave","ref","role","popper","isBlurredDescendant","relatedTarget","Node","contains","element","style","tabIndex"],"sources":["/tmp/daft-chat-temp/node_modules/stream-chat-react/dist/components/Dialog/ButtonWithSubmenu.js"],"sourcesContent":["import clsx from 'clsx';\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { useDialog, useDialogIsOpen } from './hooks';\nimport { useDialogAnchor } from './DialogAnchor';\nexport const ButtonWithSubmenu = ({ children, className, placement, Submenu, submenuContainerProps, ...buttonProps }) => {\n    const buttonRef = useRef(null);\n    const [dialogContainer, setDialogContainer] = useState(null);\n    const keepSubmenuOpen = useRef(false);\n    const dialogCloseTimeout = useRef(null);\n    const dialogId = useMemo(() => `submenu-${Math.random().toString(36).slice(2)}`, []);\n    const dialog = useDialog({ id: dialogId });\n    const dialogIsOpen = useDialogIsOpen(dialogId);\n    const { attributes, setPopperElement, styles } = useDialogAnchor({\n        open: dialogIsOpen,\n        placement,\n        referenceElement: buttonRef.current,\n    });\n    const closeDialogLazily = useCallback(() => {\n        if (dialogCloseTimeout.current)\n            clearTimeout(dialogCloseTimeout.current);\n        dialogCloseTimeout.current = setTimeout(() => {\n            if (keepSubmenuOpen.current)\n                return;\n            dialog.close();\n        }, 100);\n    }, [dialog]);\n    const handleClose = useCallback((event) => {\n        const parentButton = buttonRef.current;\n        if (!dialogIsOpen || !parentButton)\n            return;\n        event.stopPropagation();\n        closeDialogLazily();\n        parentButton.focus();\n    }, [closeDialogLazily, dialogIsOpen, buttonRef]);\n    const handleFocusParentButton = () => {\n        if (dialogIsOpen)\n            return;\n        dialog.open();\n        keepSubmenuOpen.current = true;\n    };\n    useEffect(() => {\n        const parentButton = buttonRef.current;\n        if (!dialogIsOpen || !parentButton)\n            return;\n        const hideOnEscape = (event) => {\n            if (event.key !== 'Escape')\n                return;\n            handleClose(event);\n            keepSubmenuOpen.current = false;\n        };\n        document.addEventListener('keyup', hideOnEscape, { capture: true });\n        return () => {\n            document.removeEventListener('keyup', hideOnEscape, { capture: true });\n        };\n    }, [dialogIsOpen, handleClose]);\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"button\", { \"aria-selected\": 'false', className: clsx(className, 'str_chat__button-with-submenu', {\n                'str_chat__button-with-submenu--submenu-open': dialogIsOpen,\n            }), onBlur: () => {\n                keepSubmenuOpen.current = false;\n                closeDialogLazily();\n            }, onClick: (event) => {\n                event.stopPropagation();\n                dialog.toggle();\n            }, onFocus: handleFocusParentButton, onMouseEnter: handleFocusParentButton, onMouseLeave: () => {\n                keepSubmenuOpen.current = false;\n                closeDialogLazily();\n            }, ref: buttonRef, role: 'option', ...buttonProps }, children),\n        dialogIsOpen && (React.createElement(\"div\", { ...attributes.popper, onBlur: (event) => {\n                const isBlurredDescendant = event.relatedTarget instanceof Node &&\n                    dialogContainer?.contains(event.relatedTarget);\n                if (isBlurredDescendant)\n                    return;\n                keepSubmenuOpen.current = false;\n                closeDialogLazily();\n            }, onFocus: () => {\n                keepSubmenuOpen.current = true;\n            }, onMouseEnter: () => {\n                keepSubmenuOpen.current = true;\n            }, onMouseLeave: () => {\n                keepSubmenuOpen.current = false;\n                closeDialogLazily();\n            }, ref: (element) => {\n                setPopperElement(element);\n                setDialogContainer(element);\n            }, style: styles.popper, tabIndex: -1, ...submenuContainerProps },\n            React.createElement(Submenu, null)))));\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}